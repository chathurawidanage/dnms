<div ng-controller="ChartController as cctrl">
    <div layout-padding>
        <h2>Define New Longitudinal Chart</h2>
    </div>
    <div layout="row">
        <md-content layout-padding flex="50" style="overflow-x: hidden" layout="column">
            <!--<span class="md-headline">Preview</span>-->
            <div>
                <img src="img/nopreview.jpg" ng-if="!cctrl.previewAvailable()">
                <canvas class="chart chart-line" chart-data="cctrl.lc.data" chart-labels="cctrl.lc.labels"
                        chart-series="cctrl.lc.series" chart-colors="cctrl.lc.dataColors"
                        id="chart-preview"></canvas>
            </div>
            <div>
                <md-list class="fixedRows">
                    <md-list-item class="md-2-line centile-item" ng-repeat="centile in cctrl.lc.centiles">
                        <div md-color-picker ng-model="centile.color" ng-change="cctrl.applyData()"
                             class="md-avatar"></div>
                        <div class="md-list-item-text compact">
                            <h3> {{centile.name}}</h3>
                            <md-switch ng-model="centile.selected" class="md-primary"
                                       ng-change="cctrl.applyData()" aria-label="enable">
                            </md-switch>
                        </div>
                    </md-list-item>
                </md-list>
            </div>
        </md-content>
        <md-content layout-padding flex="50">
            <span class="md-headline">Basic Configurations</span>
            <form name="chartForm">
                <md-input-container class="md-block">
                    <label>Title</label>
                    <input required name="title" ng-model="cctrl.lc.title">
                </md-input-container>
                <md-input-container class="md-block">
                    <label>Program</label>
                    <md-select ng-model="cctrl.lc.program" ng-change="cctrl.refreshDependants()">
                        <md-option ng-repeat="program in cctrl.programs" value="{{program.id}}">
                            {{program.displayName}}
                        </md-option>
                    </md-select>
                </md-input-container>
                <md-content>
                    <p>Dependant Axis/Axes Type</p>
                    <md-radio-group ng-model="cctrl.lc.dependantDataType">
                        <md-radio-button value="0" class="md-primary" selected>Single Data Element</md-radio-button>
                        <md-radio-button value="1" class="md-primary">Complex Data Element</md-radio-button>
                        <md-radio-button value="2" class="md-primary">Program Indicator</md-radio-button>
                    </md-radio-group>
                </md-content>
                <md-content layout="row">
                    <md-input-container flex="50">
                        <label ng-if="cctrl.lc.dependantDataType==0">Dependant Data Element </label>
                        <label ng-if="cctrl.lc.dependantDataType==1">Dependant Data Element I (Y)</label>
                        <label ng-if="cctrl.lc.dependantDataType==2">Dependant Program Indicator</label>
                        <md-select ng-model="cctrl.lc.yAxisVariable1">
                            <md-option ng-if="cctrl.lc.dependantDataType<2" ng-repeat="de in cctrl.dataElements" value="{{de.id}}">
                                {{de.name}}
                            </md-option>
                            <md-option ng-if="cctrl.lc.dependantDataType==2" ng-repeat="de in cctrl.programIndicators" value="{{de.id}}">
                                {{de.name}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                    <md-input-container flex="50" ng-if="cctrl.lc.dependantDataType==1">
                        <label>Dependant Data Element II (X)</label>
                        <md-select ng-model="cctrl.lc.yAxisVariable2">
                            <md-option ng-repeat="de in cctrl.dataElements" value="{{de.id}}">
                                {{de.name}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                </md-content>
                <md-content>
                    <span class="md-headline">Reference Data</span>
                </md-content>
                <md-content  layout="row">
                    <md-input-container flex="50">
                        <label>Reference Data Interval</label>
                        <md-select ng-model="cctrl.lc.xAxisPeriod">
                            <md-option ng-repeat="period in cctrl.xAxisPeriods" value="{{$index}}">
                                {{period}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                </md-content>
                <md-content>
                    <div dropzone="dropzoneConfig" class="drop-zone">
                        <div class="dz-message">
                            Drop reference data(CSV) here.
                        </div>
                    </div>
                </md-content>
            </form>
        </md-content>
    </div>

    <md-button class="md-fab md-fab md-fab-bottom-right md-faded" aria-label="Add Chart" ng-click="cctrl.navBack()"
               style="position: fixed; right: 100px">
        <md-icon>
            <i class="material-icons">navigate_before</i>
        </md-icon>
    </md-button>
    <md-button class="md-fab md-fab md-fab-bottom-right md-primary" aria-label="Add Chart" ng-click="cctrl.saveChart()"
               style="position: fixed">
        <md-icon>
            <i class="material-icons">save</i>
        </md-icon>
    </md-button>
</div>